< !DOCTYPE html >
<html>
<head>
    <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
        <button onClick="window.location.reload();">Refresh Page</button>
</head>
<body>
    //first time writing html/javascript
    <hl>Music Box Page</hl>
    
    <textarea id="input_notes" rows="5" cols="5">
A
 B
  C
   D
</textarea>
    <button id="myBtn">Play</button>
    
    <script>  
        document.getElementById("myBtn").addEventListener("click", myFunction);
        //This is where your naration begins...
        function myFunction(){
        notes_raw = $("#input_notes").val().split('\n');
        
        var notes_parsed = []
	for (i = 0; i < notes_raw.length; i++) {
 	   for (j = 0; j < notes_raw[i].length; j++) {
        if (notes_raw[i][j] == 'A'){
           notes_parsed.push('A')
           };
            if(notes_raw[i][j] == 'B'){
               notes_parsed.push('B')
           };
           if(notes_raw[i][j] == 'C'){
               notes_parsed.push('C')
           };
           if(notes_raw[i][j] == 'D'){
               notes_parsed.push('D')
           };
       };
    };

	
	index_ms_offset = 1000
	for(index = 0; index < notes_parsed.length; index++)
	{
		if(notes_parsed[index] == 'A')
		{
			 setTimeout(function(){new Audio('door_chime.mp3').play()}, index_ms_offset * index )
		} else if(notes_parsed[index] == 'B')
		{
			setTimeout(function(){new Audio('lid_close_1.mp3').play()}, index_ms_offset * index )
		} else if(notes_parsed[index] == 'C')
		{
			setTimeout(function(){new Audio('lid_close_2.mp3').play()}, index_ms_offset * index )
		} else if(notes_parsed[index] == 'D')
		{
			setTimeout(function(){new Audio('lid_close_3.mp3').play()}, index_ms_offset * index )
		}      
	}
              
var htmlTEMPLATE = "<!doctype html>"
htmlTEMPLATE = htmlTEMPLATE + "<html><head><\/head ><body>"
htmlTEMPLATE = htmlTEMPLATE + "<script>@@@PLAY_CODE <\/script>"
htmlTEMPLATE = htmlTEMPLATE + "<\/body ><\/html>"     
        
    code_output = ""
    timing = 0
    //index_ms_offset = 1000
    for (index = 0; index < notes_parsed.length; index++) { 
        if( notes_parsed[index] == 'A'){
            code_output = code_output + "setTimeout( function(){"
            code_output = code_output + "new Audio('door_chime.mp3').play()"
            code_output = code_output + "}, " + index_ms_offset + " * " + index + "); "
        }else if (notes_parsed[index] == 'B' ){
            code_output = code_output + "setTimeout( function(){"
            code_output = code_output + "new Audio('lid_close_1.mp3').play()"
            code_output = code_output + "}, " + index_ms_offset + " * " + index +");  "
        }else if (notes_parsed[index] == 'C' ){
            code_output = code_output + "setTimeout( function(){"
            code_output = code_output + "new Audio('lid_close_2.mp3').play()"
            code_output = code_output + "}, " + index_ms_offset + " * " + index +");  "
        }else if (notes_parsed[index] == 'D' ){
            code_output = code_output + "setTimeout( function(){"
            code_output = code_output + "new Audio('lid_close_3.mp3').play()"
            code_output = code_output + "}, " + index_ms_offset + " * " + index +");  "
        }
    }
        $("#compiled_code").val(htmlTEMPLATE.replace("@@@PLAY_CODE", code_output))
        
        }

    </script>
</body>
</html>